import OpenAPIParser from "@apidevtools/swagger-parser";
import { formatTypeSpec } from "@typespec/compiler";
import { generateMain } from "./generators/generate-main.js";
import { transform } from "./transforms/transforms.js";
import { createContext } from "./utils/context.js";
export async function convertOpenAPI3Document(document, { disableExternalRefs } = {}) {
    const parser = new OpenAPIParser();
    const bundleOptions = disableExternalRefs
        ? {
            resolve: { external: false, http: false, file: false },
        }
        : {};
    await parser.bundle(document, bundleOptions);
    const context = createContext(parser, document);
    const program = transform(context);
    const content = generateMain(program, context);
    try {
        return await formatTypeSpec(content, {
            printWidth: 100,
            tabWidth: 2,
        });
    }
    catch {
        return content;
    }
}
//# sourceMappingURL=convert.js.map